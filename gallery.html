<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Galleri - Branchcreek Bandits</title>

<!-- Tailwind + Fonts + Icons -->
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
<link href="https://fonts.cdnfonts.com/css/western" rel="stylesheet">

<style>
.nav-link { color: white; }
.nav-link:hover { color: #d4a017; }
.western-text { font-family: 'Western', sans-serif; }
.cursor-pointer { cursor: pointer; }

/* Gallery Grid */
.gallery-grid img {
  width: 100%;
  height: 250px;
  object-fit: cover;
  border-radius: 0.5rem;
  cursor: pointer;
}

/* Modal */
#modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  justify-content: center;
  align-items: center;
  z-index: 50;
}

#modal-img {
  max-height: 90%;
  max-width: 90%;
  border-radius: 0.5rem;
  transform: scale(0.9);
  transition: transform 0.3s ease;
}

#modal.show #modal-img { transform: scale(1); }

/* Overlay controls */
.modal-control {
  position: absolute;
  color: white;
  font-size: 2.5rem;
  cursor: pointer;
  user-select: none;
  z-index: 100;
}
#close-btn { top: 1rem; right: 2rem; }
#prev-btn { left: 1rem; top: 50%; transform: translateY(-50%); }
#next-btn { right: 1rem; top: 50%; transform: translateY(-50%); }
</style>
</head>
<body class="bg-gray-100 font-sans flex flex-col min-h-screen">

<!-- Dynamic Navbar -->
<div id="navbar"></div>

<!-- Main Content -->
<div class="flex-grow">
  <!-- Gallery Section -->
  <section class="py-16 bg-white">
    <div class="container mx-auto px-6 max-w-5xl">
      <h1 class="western-text text-5xl mb-6 text-center">Galleri</h1>
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 gallery-grid" id="gallery"></div>
    </div>

    <!-- Modal -->
    <div id="modal" class="flex">
      <img id="modal-img" src="">
      <span id="close-btn" class="modal-control" onclick="closeModal()">&times;</span>
      <span id="prev-btn" class="modal-control" onclick="prevImage()">&#10094;</span>
      <span id="next-btn" class="modal-control" onclick="nextImage()">&#10095;</span>
    </div>
  </section>
</div>

<!-- Dynamic Footer -->
<div id="footer"></div>

<!-- Scripts -->
<script>
feather.replace();

// Include HTML
function includeHTML(file, elementId, callback){
  fetch(file)
    .then(res => res.text())
    .then(data => {
      document.getElementById(elementId).innerHTML = data;
      if(callback) callback();
      feather.replace();
    })
    .catch(err => console.error(err));
}

// Load Navbar + Footer
includeHTML("nav.html", "navbar", () => {
  // Mobile menu toggle
  const menuBtn = document.getElementById('menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  if(menuBtn) menuBtn.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));

  const loginBtn = document.getElementById('login-btn');
  const loginDropdown = document.getElementById('login-dropdown');
  if(loginBtn) loginBtn.addEventListener('click', () => loginDropdown.classList.toggle('hidden'));

  const mobileLoginBtn = document.getElementById('mobile-login-btn');
  const mobileLoginForm = document.getElementById('mobile-login-form');
  if(mobileLoginBtn) mobileLoginBtn.addEventListener('click', () => mobileLoginForm.classList.toggle('hidden'));

  // âœ… Setup Firebase auth after navbar exists
  setupAuth();
});

includeHTML("footer.html", "footer");

// Gallery Images
const images = [
  "gallari/BB1.jpg",
  "gallari/BB2.jpg",
  "gallari/BB3.jpg"
];

let currentIndex = 0;
const gallery = document.getElementById('gallery');
images.forEach((src, index) => {
  const img = document.createElement('img');
  img.src = src;
  img.onclick = () => openModal(index);
  gallery.appendChild(img);
});

function openModal(index){
  currentIndex = index;
  const modal = document.getElementById('modal');
  const modalImg = document.getElementById('modal-img');
  modalImg.src = images[currentIndex];
  modal.style.display = 'flex';
  setTimeout(()=>modalImg.style.transform = 'scale(1)', 10);
}

function closeModal(){
  const modal = document.getElementById('modal');
  const modalImg = document.getElementById('modal-img');
  modalImg.style.transform = 'scale(0.9)';
  setTimeout(()=> modal.style.display='none', 300);
}

function nextImage(){
  currentIndex = (currentIndex + 1) % images.length;
  document.getElementById('modal-img').src = images[currentIndex];
}

function prevImage(){
  currentIndex = (currentIndex - 1 + images.length) % images.length;
  document.getElementById('modal-img').src = images[currentIndex];
}
</script>

<!-- Firebase Auth -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCzk3xKdC0p9logWjGIZX41M1oeIeqjxGI",
  authDomain: "branchcreek-bandits.firebaseapp.com",
  projectId: "branchcreek-bandits",
  storageBucket: "branchcreek-bandits.firebasestorage.app",
  messagingSenderId: "828305260971",
  appId: "1:828305260971:web:6c3601fc97601a9621d2ee",
  measurementId: "G-550TRD5SQ3"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

window.setupAuth = function() {
  function updateMenu(name) {
    const loginBtn = document.getElementById("login-btn");
    const mobileLoginBtn = document.getElementById("mobile-login-btn");
    if(loginBtn) loginBtn.innerHTML = `${name} <button onclick="logout()" class="ml-2 text-red-500 font-bold">Log ud</button>`;
    if(mobileLoginBtn) mobileLoginBtn.innerHTML = `${name} <button onclick="logout()" class="ml-2 text-red-500 font-bold">Log ud</button>`;
  }

  window.login = function() {
    const email = document.getElementById("login-email").value;
    const password = document.getElementById("login-password").value;

    signInWithEmailAndPassword(auth,email,password)
      .then(userCredential => {
        updateMenu(userCredential.user.displayName || userCredential.user.email);
        document.getElementById("login-dropdown").classList.add("hidden");
      })
      .catch(err=>alert(err.message));
  }

  window.mobileLogin = function() {
    const email = document.getElementById("mobile-login-email").value;
    const password = document.getElementById("mobile-login-password").value;

    signInWithEmailAndPassword(auth,email,password)
      .then(userCredential => {
        updateMenu(userCredential.user.displayName || userCredential.user.email);
        document.getElementById("mobile-login-form").classList.add("hidden");
      })
      .catch(err=>alert(err.message));
  }

  onAuthStateChanged(auth,user=>{
    if(user) updateMenu(user.displayName || user.email);
  });

  window.logout = function() {
    signOut(auth).then(()=> location.reload()).catch(err=>alert(err.message));
  }
}
</script>

</body>
</html>
