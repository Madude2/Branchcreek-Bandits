<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kontakt - Branchcreek Bandits</title>

<!-- Tailwind + Fonts + Icons -->
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
<link href="https://fonts.cdnfonts.com/css/western" rel="stylesheet">

<style>
  .nav-link { color: white; }
  .nav-link:hover { color: #d4a017; }
  .western-text { font-family: 'Western', sans-serif; }
</style>
</head>

<body class="bg-gray-100 font-sans flex flex-col min-h-screen">

<!-- Dynamic Navbar -->
<div id="navbar"></div>

<!-- Main Content -->
<main class="flex-grow">
  <section class="py-16 bg-white">
    <div class="container mx-auto px-6 max-w-4xl text-center">
      <h1 class="western-text text-5xl mb-6">Kontakt</h1>
      <p class="text-gray-700 mb-4">
        Send sheriffen en e-mail, hvis du er interesseret i at h√∏re mere om Western Shooting.
      </p>
      <p class="text-gray-700 mb-4">
        E-mail: 
        <a href="mailto:poul@ljg.dk" class="text-blue-600 underline hover:text-blue-800">
          poul@ljg.dk
        </a>
      </p>

      <!-- üëá Visible only to admins -->
      <div id="admin-contact-section" class="hidden mt-10 p-6 bg-yellow-50 border border-yellow-300 rounded-lg shadow-md">
        <h2 class="western-text text-2xl mb-3">üîí Admin Panel</h2>
        <p class="text-gray-700 mb-2">Du er logget ind som <strong>administrator</strong>.</p>
        <p class="text-gray-600">Her kan du fx se kontaktforesp√∏rgsler eller redigere oplysninger.</p>
        <button 
          id="open-admin-dashboard" 
          class="mt-4 bg-yellow-600 hover:bg-yellow-700 text-white px-5 py-2 rounded-lg font-semibold transition transform hover:scale-105">
          √Öbn Admin Dashboard
        </button>
      </div>
    </div>
  </section>
</main>

<!-- Dynamic Footer -->
<div id="footer"></div>

<!-- -------- includeHTML helper -------- -->
<script>
async function includeHTML(file, elementId, callback){
  try {
    const res = await fetch(file);
    const html = await res.text();
    const mount = document.getElementById(elementId);
    mount.innerHTML = html;

    // Execute embedded scripts
    const scripts = mount.querySelectorAll("script");
    for (const oldScript of scripts) {
      const s = document.createElement("script");
      for (const attr of oldScript.attributes) s.setAttribute(attr.name, attr.value);
      if (!oldScript.src) s.textContent = oldScript.textContent;
      document.body.appendChild(s);
    }

    if (window.feather) feather.replace();
    if (callback) callback();
  } catch (err) {
    console.error("includeHTML error:", err);
  }
}
</script>

<!-- -------- Load Navbar + Footer -------- -->
<script>
includeHTML("nav.html", "navbar", () => {
  if (typeof setupAuth === "function") setupAuth();

  const menuBtn=document.getElementById('menu-btn');
  const mobileMenu=document.getElementById('mobile-menu');
  if(menuBtn && mobileMenu) menuBtn.addEventListener('click',()=>mobileMenu.classList.toggle('hidden'));

  const loginBtn=document.getElementById('login-btn');
  const loginDropdown=document.getElementById('login-dropdown');
  if(loginBtn && loginDropdown) loginBtn.addEventListener('click',()=>loginDropdown.classList.toggle('hidden'));

  const mobileLoginBtn=document.getElementById('mobile-login-btn');
  const mobileLoginForm=document.getElementById('mobile-login-form');
  if(mobileLoginBtn && mobileLoginForm) mobileLoginBtn.addEventListener('click',()=>mobileLoginForm.classList.toggle('hidden'));

  setTimeout(() => {
    if (typeof window.refreshNotificationsBadge === "function") {
      window.refreshNotificationsBadge();
    }
  }, 1200);
});

includeHTML("footer.html", "footer");
</script>

<!-- ‚úÖ Firebase Role-Based Logic -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCzk3xKdC0p9logWjGIZX41M1oeIeqjxGI",
  authDomain: "branchcreek-bandits.firebaseapp.com",
  projectId: "branchcreek-bandits",
  storageBucket: "branchcreek-bandits.appspot.com",
  messagingSenderId: "828305260971",
  appId: "1:828305260971:web:6c3601fc97601a9621d2ee",
  measurementId: "G-550TRD5SQ3"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const adminSection = document.getElementById("admin-contact-section");
const dashboardBtn = document.getElementById("open-admin-dashboard");

onAuthStateChanged(auth, async (user) => {
  if (!user) {
    adminSection.classList.add("hidden");
    return;
  }

  try {
    const userDoc = await getDoc(doc(db, "users", user.uid));
    if (userDoc.exists() && userDoc.data().role === "admin") {
      adminSection.classList.remove("hidden");
      dashboardBtn.addEventListener("click", () => {
        // üß≠ Open Admin Dashboard
        window.location.href = "adminDashboard.html"; // Same tab
        // Or: window.open("adminDashboard.html", "_blank"); // New tab
      });
    } else {
      adminSection.classList.add("hidden");
    }
  } catch (err) {
    console.error("‚ùå Error checking admin role:", err);
    adminSection.classList.add("hidden");
  }
});
</script>

<!-- Shared Scripts -->
<script type="module" src="js/firebase.js"></script>
<script type="module" src="js/auth.js"></script>
<script type="module" src="js/common.js"></script>

</body>
</html>
